<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Complaints - Smart Complaint System</title>

    <!-- ⭐ Font Awesome for Delete Icon (Fully Working CDN) -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          integrity="sha512-G7o3GjGWg4Ei5pG2Nv99Cc07I0FvCnyl3yS0i11KaCagH75rew35Fh5bZ0pJ3GiW3/YBYYz0RNHEdkw3P5H3JQ=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer" />

    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">

    <style>

        body {
            background: #eef2f7;
            font-family: "Inter", sans-serif;
            padding: 35px 0;
        }

        .container {
            width: min(1000px, 92%);
            margin: auto;
            background: white;
            padding: 30px 35px;
            border-radius: 14px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            animation: fadeIn 0.35s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        h2 {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            color: #1f2937;
            margin-bottom: 25px;
        }

        .table-wrapper { overflow-x: auto; }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 750px;
        }

        thead {
            background: #2563eb;
            color: white;
        }

        th, td {
            padding: 14px;
            font-size: 15px;
        }

        th { font-weight: 700; text-align: left; }

        td {
            border-bottom: 1px solid #e5e7eb;
            color: #374151;
        }

        tbody tr:hover { background: #f9fafb; }

        /* STATUS BADGES */
        .status-badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
        }

        .pending { background: #fde68a; color: #92400e; }
        .resolved { background: #bbf7d0; color: #065f46; }
        .in-progress { background: #bfdbfe; color: #1e40af; }

        /* VIEW BUTTON */
        .btn-view {
            background: #10b981;
            padding: 7px 14px;
            text-decoration: none;
            color: white;
            font-size: 14px;
            border-radius: 8px;
            font-weight: 600;
            margin-right: 6px;
            display: inline-flex;
            align-items: center;
            transition: 0.2s;
        }

        .btn-view:hover { background: #0a8f68; }

        /* DELETE BUTTON */
        .btn-delete {
            background: #ef4444;
            padding: 7px 12px;
            text-decoration: none;
            color: white;
            font-size: 14px;
            border-radius: 8px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            transition: 0.2s;
        }

        .btn-delete:hover { background: #dc2626; }

        .btn-delete i {
            font-size: 16px;
        }

        /* BACK BUTTON */
        .back-btn {
            display: flex;
            justify-content: center;
            margin-top: 25px;
        }

        .back-btn a {
            padding: 10px 22px;
            background: #fbbf24;
            color: #1f2937;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: 0.2s;
        }

        .back-btn a:hover { background: #f59e0b; }

    </style>

</head>

<body>

<!-- NAVBAR -->
<div th:replace="fragments/navbar :: navbar"></div>

<!-- MAIN CONTENT -->
<div class="container">

    <h2>User Complaint List</h2>

    <!-- If No Complaints -->
    <p th:if="${complaints.size() == 0}"
       style="text-align:center; padding:10px 0; color:red; font-size:16px;">
        No complaints found for this user.
    </p>

    <!-- Complaints Table -->
    <div class="table-wrapper" th:if="${complaints.size() > 0}">

        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>Category</th>
                <th>Description</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
            </thead>

            <tbody>

            <tr th:each="c : ${complaints}">
                <td th:text="${c.id}"></td>
                <td th:text="${c.category}"></td>
                <td th:text="${c.description}"></td>

                <!-- Status Badge -->
                <td>
                        <span th:class="'status-badge ' +
                                    (${c.status} == 'Pending' ? 'pending' :
                                     (${c.status} == 'Resolved' ? 'resolved' : 'in-progress'))"
                              th:text="${c.status}">
                        </span>
                </td>

                <!-- ACTION BUTTONS -->
                <td>

                    <!-- View Button -->
                    <a th:href="@{'/complaints/' + ${c.id}}" class="btn-view">
                        View
                    </a>

                    <!-- Delete Button with Icon -->
                    <a th:href="@{'/complaints/delete/' + ${c.id}}"
                       onclick="return confirm('Are you sure you want to delete this complaint?');"
                       class="btn-delete">
                        <i class="fa-solid fa-trash"></i>
                    </a>


                </td>

            </tr>

            </tbody>
        </table>

    </div>

    <!-- BACK BUTTON -->
    <div class="back-btn">
        <a th:href="@{/complaints/list}">← Back to All Complaints</a>
    </div>

</div>

</body>
</html>
